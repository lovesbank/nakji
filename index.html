<!DOCTYPE html>
<html lang="ko">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1">
<title>낙지잡이 정산</title>

<meta name="theme-color" content="#0a84ff">
<meta name="apple-mobile-web-app-capable" content="yes">

<style>
:root{
  --bg:#f2f2f7; --text:#111;
  --card:#f5f5f7; --card2:#fff;
  --line:#e5e5ea; --primary:#007aff;
}
@media(prefers-color-scheme:dark){
  :root{
    --bg:#000; --text:#f5f5f7;
    --card:#101012; --card2:#16161a;
    --line:#2c2c2e; --primary:#0a84ff;
  }
}
*{box-sizing:border-box}
body{
  font-family:system-ui,-apple-system;
  max-width:720px;margin:20px auto;
  padding:0 14px;background:var(--bg);color:var(--text)
}
h1{text-align:center;margin-bottom:12px}

.card{
  background:var(--card);
  border:1px solid var(--line);
  border-radius:14px;padding:14px;margin-bottom:12px
}
.cardInner{
  background:var(--card2);
  border:1px solid var(--line);
  border-radius:14px;padding:12px
}
label{font-size:14px;margin-top:8px;display:block}
input{
  width:100%;padding:10px;margin-top:6px;
  border:1px solid var(--line);
  border-radius:12px;font-size:16px
}
.row{display:flex;gap:10px}
.row>div{flex:1}

button{
  width:100%;padding:12px;
  border-radius:14px;border:none;
  background:var(--primary);color:#fff;
  font-size:16px;margin-top:12px
}
.ghost{background:var(--card2);color:var(--text);border:1px solid var(--line)}
.btnRow{display:flex;gap:10px;flex-wrap:wrap}
.btnRow button{width:100%}

.summaryGrid{
  display:grid;grid-template-columns:repeat(2,1fr);gap:10px
}
.summaryItem{
  background:var(--card2);
  border:1px solid var(--line);
  border-radius:14px;padding:10px
}
.summaryLabel{font-size:12px;opacity:.7}
.summaryValue{font-weight:800;font-size:16px}

.result{
  white-space:pre-line;
  background:var(--card2);
  border:1px solid var(--line);
  border-radius:14px;
  padding:12px;margin-top:12px
}

/* 개인당 스텝퍼 */
.stepper{display:flex;gap:8px;margin-top:6px}
.stepper button{
  width:44px;font-size:20px;
  background:var(--card2);color:var(--text)
}
.stepper input{text-align:center;font-weight:700}
</style>
</head>

<body>
<h1>낙지잡이</h1>

<!-- 정산 요약 -->
<div class="card">
  <div class="summaryGrid">
    <div class="summaryItem"><div class="summaryLabel">낙지총합</div><div id="sNakji" class="summaryValue">0원</div></div>
    <div class="summaryItem"><div class="summaryLabel">총경비</div><div id="sCost" class="summaryValue">0원</div></div>
    <div class="summaryItem"><div class="summaryLabel">최종합계</div><div id="sFinal" class="summaryValue">0원</div></div>
    <div class="summaryItem"><div class="summaryLabel">개인당</div><div id="sPer" class="summaryValue">0원</div></div>
  </div>
</div>

<!-- 입력 -->
<div class="card" id="inputCard">
  <label>정산 메모</label>
  <input id="memo" placeholder="예: 1/1 여수">

  <div class="row">
    <div><label>낙지1 kg</label><input id="kg1" type="number"></div>
    <div><label>단가</label><input id="p1"></div>
  </div>

  <div class="row">
    <div><label>낙지2 kg</label><input id="kg2" type="number"></div>
    <div><label>단가</label><input id="p2"></div>
  </div>

  <div class="row">
    <div><label>입감 박스</label><input id="ice" type="number"></div>
    <div><label>입감 단가</label><input id="iceP" value="60000"></div>
  </div>

  <div class="row">
    <div><label>기름 수량</label><input id="fuel" type="number"></div>
    <div><label>기름 단가</label><input id="fuelP" value="200000"></div>
  </div>

  <label>부식</label><input id="food">

  <label>개인당 나누기</label>
  <div class="stepper">
    <button onclick="step(-0.5)">−</button>
    <input id="div" value="4.5">
    <button onclick="step(0.5)">+</button>
  </div>

  <button onclick="calc()">계산하기</button>

  <div class="btnRow">
    <button class="ghost" onclick="copyText()">카톡으로 보내기(복사)</button>
    <button class="ghost" onclick="saveImage()">이미지 저장(PNG)</button>
    <button class="ghost" onclick="shareImage()">카톡으로 이미지 보내기</button>
    <button class="ghost" onclick="window.print()">PDF 저장</button>
  </div>

  <div class="result" id="result">값 입력 → 계산하기</div>
</div>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
const $=id=>document.getElementById(id);
function won(x){return Math.round(x).toLocaleString()+"원"}
function num(v){return Number(v)||0}
function step(d){
  let v=num($("div").value)||4.5;
  v=Math.max(0.5,Math.round((v+d)*2)/2);
  $("div").value=v;
}
function calc(){
  const t1=num($("kg1").value)*num($("p1").value);
  const t2=num($("kg2").value)*num($("p2").value);
  const nakji=t1+t2;
  const cost=
    num($("ice").value)*num($("iceP").value)+
    num($("fuel").value)*num($("fuelP").value)+
    nakji*0.05+
    num($("food").value);
  const final=nakji-cost;
  const per=final/num($("div").value);

  $("sNakji").innerText=won(nakji);
  $("sCost").innerText=won(cost);
  $("sFinal").innerText=won(final);
  $("sPer").innerText=won(per);

  $("result").innerText=
`최종합계: ${won(final)}
개인당: ${won(per)}`;
}
function copyText(){
  navigator.clipboard.writeText($("result").innerText);
}
async function saveImage(){
  const c=await html2canvas(document.body,{scale:2});
  const a=document.createElement("a");
  a.href=c.toDataURL("image/png");
  a.download="정산.png";
  a.click();
}
async function shareImage(){
  const c=await html2canvas(document.body,{scale:2});
  const b=await new Promise(r=>c.toBlob(r));
  if(navigator.share){
    navigator.share({files:[new File([b],"정산.png",{type:"image/png"})]});
  }
}
</script>
</body>
</html>
